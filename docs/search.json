[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "FototrampeoR: OrganizacioÃÅn y an√°lisis de datos de mamiÃÅferos medianos y grandes con datos de c√°maras trampa",
    "section": "",
    "text": "Hola a todos bienvenidos al curso pre-congreso de FototrampeoR: Organizaci√≥n y an√°lisis de datos de mam√≠feros medianos y grandes con datos de c√°maras trampa. En esta p√°gina encontrar√°n todas las instrucciones para llevar a cabo el curso."
  },
  {
    "objectID": "index.html#instalar-r-y-rstudio",
    "href": "index.html#instalar-r-y-rstudio",
    "title": "FototrampeoR: OrganizacioÃÅn y an√°lisis de datos de mamiÃÅferos medianos y grandes con datos de c√°maras trampa",
    "section": "Instalar R y Rstudio",
    "text": "Instalar R y Rstudio\nTodos los ejercicios del curso se desarrollar√°n en el lenguaje de programaci√≥n R y usando la interfaz de Rstudio"
  },
  {
    "objectID": "index.html#instalar-paqueter√≠as",
    "href": "index.html#instalar-paqueter√≠as",
    "title": "FototrampeoR: OrganizacioÃÅn y an√°lisis de datos de mamiÃÅferos medianos y grandes con datos de c√°maras trampa",
    "section": "Instalar paqueter√≠as",
    "text": "Instalar paqueter√≠as\nSe espera que previo al curso instales las siguientes paqueter√≠as\n\ninstall.packages(c(\"tidyverse\", # Easily Install and Load the 'Tidyverse'\n\"vegan\", # Community Ecology Package\n\"ggrepel\", # Automatically Position Non-Overlapping Text Labels with 'ggplot2'\n\"SpadeR\", # Species-Richness Prediction and Diversity Estimation with R\n\"BiodiversityR\", # Package for Community Ecology and Suitability Analysis\n\"iNEXT\", # Interpolation and Extrapolation for Species Diversity\n\"hillR\", # Diversity Through Hill Numbers\n\"MuMIn\", # Multi-Model Inference\n\"DHARMa\", # Residual Diagnostics for Hierarchical (Multi-Level / Mixed\", Regression Models\n\"camtrapR\", # Camera Trap Data Management and Preparation of Occupancy and Spatial Capture-Recapture Analyses\n\"leaflet\", # Create Interactive Web Maps with the JavaScript 'Leaflet' Library\n\"sp\", # Classes and Methods for Spatial Data\n\"ggtext\", # Improved Text Rendering Support for 'ggplot2'\n\"AICcmodavg\", # Model Selection and Multimodel Inference Based on (Q\",AIC(c\",\n\"broom\", # Convert Statistical Objects into Tidy Tibbles\n\"ggeffects\", # Create Tidy Data Frames of Marginal Effects for 'ggplot' from Model Outputs\n\"performance\" # Assessment of Regression Models Performance\n))"
  },
  {
    "objectID": "index.html#d√≠a-1",
    "href": "index.html#d√≠a-1",
    "title": "FototrampeoR: OrganizacioÃÅn y an√°lisis de datos de mamiÃÅferos medianos y grandes con datos de c√°maras trampa",
    "section": "D√≠a 1",
    "text": "D√≠a 1\n\nIntroducci√≥n al dise√±o de muestreo en estudios de c√°maras trampa\nIntroducci√≥n a R\nDigiKam para el etiquetado de fotos\nCamtrapR: organizaci√≥n y manejo de datos de c√°maras trampa"
  },
  {
    "objectID": "index.html#d√≠a-2",
    "href": "index.html#d√≠a-2",
    "title": "FototrampeoR: OrganizacioÃÅn y an√°lisis de datos de mamiÃÅferos medianos y grandes con datos de c√°maras trampa",
    "section": "D√≠a 2",
    "text": "D√≠a 2\n\nIntroducci√≥n al √≠ndice de abundancia relativa\nIntroducci√≥n al an√°lisis de diversidad\nGr√°fica de radar para datos de actividad\nAn√°lisis de actividad diaria"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "IAR_doc.html",
    "href": "IAR_doc.html",
    "title": "Indice de ¬øabundancia? relativa (RAI)",
    "section": "",
    "text": "La estimaci√≥n de la abundancia de poblaciones es de vital importancia para la conservaci√≥n de la vida silvestre. En el caso de los mam√≠feros, las c√°maras trampa son una de las m√©todos de muestreo m√°s usados (Burton et al. 2015).\n\n\n\nEn especies marcadas o con marcas naturales es posible usar modelos de captura recaptura para estimar la abundancia (Wearn and Glover-Kapfer 2017).\n\nPero en especies que no tienen marcas es dif√≠cil o imposible reconocer individuos a partir de fotograf√≠as, lo que no permite usar modelos de captura recaptura.\n\nEn estos casos muchas veces se usan √≠ndices para realizar inferencias sobre la abundancia de especies (O‚ÄôConnell, Nichols, and Karanth 2010; Timothy G. O‚ÄôBrien, Kinnaird, and Wibisono 2003)."
  },
  {
    "objectID": "IAR_doc.html#del-rai-a-la-abundancia",
    "href": "IAR_doc.html#del-rai-a-la-abundancia",
    "title": "Indice de ¬øabundancia? relativa (RAI)",
    "section": "Del RAI a la abundancia",
    "text": "Del RAI a la abundancia\nC√≥mo cualquier otro √≠ndice, la utilidad del RAI para realizar inferencias sobre la abundancia de especies depende de que cumpla con ciertos supuestos generales.\n\nLos registros fotogr√°ficos deben ser independientes en el tiempo\nPoblaci√≥n cerrada, el RAI no cambia durante el muestreo\nTodos los animales/individuos son detectados si est√°n presentes\n\nS√≠ todo esto es cierto para el RAI, entonces se espera que te√≥ricamente tenga una correlaci√≥n con la abundancia poblacional ‚Äúreal‚Äù (O‚ÄôConnell, Nichols, and Karanth 2010; Timothy G. O‚ÄôBrien, Kinnaird, and Wibisono 2003).\n\nRegistros independientes ‚è≤Ô∏è\nSeguramente en tus proyectos o tesis te han dicho que debes considerar solamente los registros independientes para calcular el RAI. Pero, ¬øqu√© es un registro independiente?\n\nMuchas personas intuyen que un registro independiente es aquel donde se tiene cierta certeza de que el mismo individuo no es fotografiado de manera consecutiva. Entonces, muy inocentemente definen en su tesis o art√≠culo 30/60/1440 minutos como el umbral m√°gico, en el cual dos registros no pertenecen al mismo individuo. Citando seguramente a otra persona que tambi√©n ha hecho lo mismo (R. Sollmann 2018).\nEstamos olvidando algo crucial y es que usamos el RAI porque no podemos reconocer individuos y por lo tanto no tenemos la certeza de que un individuo diferente pasa en la c√°mara despu√©s de xx cantidad de tiempo.\nRealmente definimos los registros ‚Äúindependientes‚Äù para evitar las pseudo-replicas temporales. Es decir, registros que nos dan la misma informaci√≥n debido a que est√°n muy cercanos entre s√≠. Pero, elegir un intervalo no es una tarea trivial, ya que: un intervalo muy peque√±o puede hacer que tengamos registros dependientes, lo que resulta en que sobre-estimemos el √≠ndice o que se invaliden muchas pruebas estad√≠sticas (Carroll and Pearson 2000). Pero escoger un intervalo muy grande puede hacer que perdamos informaci√≥n, lo cual no es algo deseable para especies poco comunes.\n\n¬ø C√≥mo escoger un intervalo adecuado? sigue siendo una pregunta dif√≠cil. Lo mejor que podemos hacer es definir ese intervalo con base en el conocimiento ecol√≥gico y del movimiento de la especie objetivo (R. Sollmann 2018). Existe tambi√©n la posibilidad de definir el umbral de independencia de manera m√°s formal explorando la autocorrelaci√≥n temporal de los registros (Kays and Parsons 2014; F. Iannarilli et al. 2019) o la inspecci√≥n de los intervalos de registros subsecuentes (Yasuda 2004).\n\nPor lo general las t√©cnicas estad√≠sticas formales para definir independencia temporal son poco usadas por la falta de informaci√≥n y herramientas que sean relativamente dif√≠ciles de aplicar. Aunque en este campo el paquete lorelogram (F. Iannarilli et al. 2019) parece ser muy promisorio. En todo caso las primeras aplicaciones del paquete muestran que para la mayor√≠a de los casos la dependencia espacial se pierde con tan solo 3 minutos y en casos extremos 15 min (con atrayentes) (Fabiola Iannarilli et al. 2021).\n\n\nPoblaci√≥n cerrada\nSeguramente la mayor√≠a tambi√©n ha escuchado hablar del supuesto de poblaci√≥n cerrada. De manera general una poblaci√≥n cerrada se da idealmente en determinado periodo de tiempo donde no sucedan muertes, nacimientos, migraci√≥n o emigraci√≥n de individuos (Schoen and Kim 1991). Esto es particularmente importante cuando intentamos hacer inferencias sobre el par√°metros poblacionales de una especie, en este caso abundancia.\nVamos a verlo con un ejemplo exagerado, pero espero que ilustre lo importante que puede ser el supuesto. Imaginemos que tenemos tres a√±os de conteos de una poblaci√≥n de un c√°nido en un √°rea determinada. Por alg√∫n motivo esta poblaci√≥n esta disminuyendo cada a√±o. Sin embargo, s√≠ yo defino mi temporada de muestreo como los 3 a√±os, no ser√° posible evidenciar la disminuci√≥n de la poblaci√≥n. Al realizar cada conteo por a√±o si sera posible. Esto mismo puede suceder a escala de meses o de temporadas clim√°ticas, pero claro todo va a depender del sistema de estudio y el conocimiento que tengamos del mismo.\n\n\n\n¬ø Detectamos todo los que existe ?\nEl RAI supone que todos los individuos que se encuentren en el √°rea ser√°n fotografiados, es decir que la probabilidad de detecci√≥n es perfecta. En otras palabras, si tenemos la total seguridad de registrar todos los individuos que pasen en frente de la c√°mara trampa, tendremos la certeza de que los cambios en la tasa fotogr√°fica se deban a los cambios en la abundancia de la especie. B√°sicamente que la relaci√≥n de la abundancia real y el RAI sea monot√≥nica (Timothy G. O‚ÄôBrien 2011).\n\n\n\nPalmer et al 2018 Relaci√≥n del RAI con estimaciones de densidad con vuelos\n\n\nAutores c√≥mo Palmer et al. (2018) han demostrado que bajo ciertas circunstancias el RAI puede ser un buen reflejo de la abundancia. No obstante, en la mayor√≠a de los casos la probabilidad de detecci√≥n de las especies no es perfecta (K√©ry et al. 2009; Burton et al. 2015). Esto quiere decir que es bastante probable que pese a que no detectemos a una especie en una unidad y d√≠a determinado, es dif√≠cil llegar a concluir que en efecto esta ausente. Lo cual termina por generar que subestimemos el par√°metro de inter√©s (Martin-Garcia et al. 2022).\n\n\n\nModificado de G√°lvez, N., Gonz√°lez, M. J., Vuskovic, T., Ba√±ales- Seguel, C., Opazo, A., Mart√≠nez, D., Zurita, R., Ortega, F., & Schuttler, S. (2020). Monitoreo escolar de fauna silvestre: Gu√≠a docente para realizar un proyecto cent√≠fico escolar mediante foto trampeo (First ed.) Proyecto EXPLORA de Divulgaci√≥n y Valoraci√≥n de la Cienciay Tecnolog√≠a 2018-2019 de CONICYT ED220040.\n\n\nEn c√°maras trampa la detecci√≥n imperfecta es un fen√≥meno muy com√∫n. Recordemos que como herramientas de monitoreo pasivo las c√°maras tienen un √°rea efectiva de muestreo bastante peque√±a (Andrade-Ponce et al. 2021; Moeller et al. 2022). En otras palabras, la probabilidad de que una especie pase frente al √°rea donde el sensor de la c√°mara se active y sea registrada, realmente es baja (Moeller et al. 2022).\n\nExisten diversos factores que pueden llegar a afectar la detecci√≥n de las especies, desde su abundancia natural, el tama√±o del √°mbito hogare√±o, el tipo de h√°bitat, el lugar en que ubiquemos la c√°mara, entre otras (Burton et al. 2015; Andrade-Ponce et al. 2021; Guillera-Arroita 2016). Lo cierto es que se ha demostrado que llegar a ignorar la detecci√≥n imperfecta de las especies puede hacernos llegar a conclusiones totalmente contrarias sobre la abundancia de las mismas (Rahel Sollmann et al. 2013).\n\n\nEl uso del espacio afecta la interpretaci√≥n\nSi en alg√∫n mundo id√≠lico cumplimos con los supuestos que ya mencionamos, podr√≠amos llegar a pensar que los cambios en el RAI son un buen reflejo de los cambios en la abundancia de poblacional. No obstante, el uso del h√°bitat o del espacio tambi√©n puede afectar la tasa de registro (Stewart et al. 2018). Por ejemplo, especies que se mueven r√°pido a lo largo de su territorio pueden ser detectadas mayor n√∫mero de veces, mientras que una especie de movimiento ‚Äúlento‚Äù no. De manera, similar especies con √°mbitos hogare√±os m√°s amplios, pueden ser detectadas en distintas estaciones, aumentando el n√∫mero de detecciones totales (Broadley et al. 2019).\n\nCreo que una manera sensata de usar el RAI es como una medida de actividad o intensidad de uso (Timothy G. O‚ÄôBrien 2011). Por supuesto seguimos teniendo el problema de la detecci√≥n imperfecta, pero al menos no hacemos inferencia sobre una abundancia, sino sobre la relaci√≥n entre la tasa de detecci√≥n y alguna covariable como el h√°bitat o un disturbio. Precisamente, en este ejemplo vamos a usar el RAI para explicar la relaci√≥n de la especie con algunas covariables y para ello usaremos modelos lineales. Manos a la obra:"
  },
  {
    "objectID": "IAR_doc.html#librer√≠as",
    "href": "IAR_doc.html#librer√≠as",
    "title": "Indice de ¬øabundancia? relativa (RAI)",
    "section": "Librer√≠as",
    "text": "Librer√≠as\nUsaremos las siguientes librer√≠as en R\n\nlibrary(camtrapR) # Camera Trap Data Management and Preparation of Occupancy and Spatial Capture-Recapture Analyses\nlibrary(tidyverse) # Easily Install and Load the 'Tidyverse'\nlibrary(leaflet) # Create Interactive Web Maps with the JavaScript 'Leaflet' Library\nlibrary(sp) # Classes and Methods for Spatial Data\nlibrary(ggtext) # Improved Text Rendering Support for 'ggplot2'\nlibrary(AICcmodavg) # Model Selection and Multimodel Inference Based on (Q)AIC(c)\nlibrary(broom) # Convert Statistical Objects into Tidy Tibbles\nlibrary(ggeffects) # Create Tidy Data Frames of Marginal Effects for 'ggplot' from Model Outputs\nlibrary(performance) # Assessment of Regression Models Performance"
  },
  {
    "objectID": "IAR_doc.html#datos",
    "href": "IAR_doc.html#datos",
    "title": "Indice de ¬øabundancia? relativa (RAI)",
    "section": "Datos",
    "text": "Datos\nVamos a cargar unos datos de c√°maras trampa del a√±o 2020. Seguiremos el flujo de trabajo que emplea camtrapR, por lo cual cargaremos las tablas que generamos a partir del paquete: la tabla de funcionamiento de c√°maras y la de registros.\nVamos a cargar la tabla de operaci√≥n de c√°maras\n\n# Usar√© la funci√≥n read.delim debido a que mi tabla esta en formato txt, pero generalmente camtrapR genera csv. En ese caso se usa read.csv\nCT_table <- read.delim(\"Data/CT_cams.txt\")\n\n\n\n\n\n\nStation\nutm_y\nutm_x\nSetup_date\nRetrieval_date\n\n\n\n\nCBG01\n2007508\n696396\n22/02/2020\n22/04/2020\n\n\nCBG02\n2008327\n695788\n22/02/2020\n22/04/2020\n\n\nCBG03\n2009568\n695414\n21/02/2020\n22/04/2020\n\n\nCBG04\n2010475\n695052\n21/02/2020\n22/04/2020\n\n\nCBG05\n2011016\n694286\n21/02/2020\n22/04/2020\n\n\nCBG06\n2007026\n695603\n22/02/2020\n22/04/2020\n\n\n\n\n\nUn paso muy importante es verificar que las coordenadas sean las correctas, y la manera m√°s sencilla de saberlo es mediante gr√°ficos. Nosotros haremos un mapa interactivo para verificar que todo est√© en orden\n\n# Generar objeto espacial para el mapa\nCT_points <- SpatialPoints(cbind(CT_table$utm_x, \n                                 CT_table$utm_y),\n                           proj4string = CRS('+proj=utm +datum=WGS84 +zone=14 +towgs84=0,0,0')) \n# Proyectar a WGS solo para este paso\nCT_points <- spTransform(CT_points, \"+proj=longlat +datum=WGS84\")\n\n# Generar el mapa\nm <- leaflet() %>%\n  addProviderTiles(providers$Esri.WorldImagery, group=\"Satellite\") %>%  # Imagen satelital\n  addProviderTiles(providers$Esri.WorldTopoMap, group=\"Base\") %>% \n  addCircleMarkers(lng=sp::coordinates(CT_points)[,1], lat=sp::coordinates(CT_points)[,2], \n                   popup= paste(CT_table$Station)) %>%\n  # Layers control\n  addLayersControl(\n    baseGroups = c(\"Satellite\", \"Base\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )\nm\n\n\n\n\n\nAhora vamos a cargar los registros de las especies. Usaremos la base de datos que genera la funci√≥n surveReport de CamtrapR, espec√≠ficamente la del conteo de detecci√≥n de las especies y la del esfuerzo de muestreo de las c√°maras\n\n# Registros sin delta de independencia\nregistrosD0 <- read.csv(\"Data/events_by_station_d0.csv\")\n\n# Registros con independencia de 15 min\nregistrosD15 <- read.csv(\"Data/events_by_station_d15.csv\")\n\n# Registros con independencia de 30 min\nregistrosD30 <- read.csv(\"Data/events_by_station_d30.csv\")\n\n# Registros con independencia de 60 min\nregistrosD60 <- read.csv(\"Data/events_by_station_d60.csv\")\n\nCada tabla de registros se ve as√≠:\n\n\n\n\n\nStation\nSpecies\nn_events\n\n\n\n\nCBG01\nBassariscus astutus\n0\n\n\nCBG01\nBird\n1\n\n\nCBG01\nBug\n0\n\n\nCBG01\nCanis latrans\n0\n\n\nCBG01\nCanis lupus familiaris\n2\n\n\nCBG01\nCapra aegagrus hircus\n15\n\n\n\n\n\nPara calcular el RAI ahora necesitamos el dato de funcionamiento de c√°maras, el cual tambi√©n podemos obtener de las salidas del surveReport\n\nCam_esf <- read.csv2(\"Data/survey_dates.csv\") %>% \n  select(Station, n_nights_active) # Selecciono las columnas que voy a usar\n# NOTA: uso read.csv2 porque mi compu guarda los csv usando el ; como separador\n\n\n\n\n\n\nStation\nn_nights_active\n\n\n\n\nCBG01\n60\n\n\nCBG02\n60\n\n\nCBG03\n61\n\n\nCBG04\n61\n\n\nCBG05\n61\n\n\nCBG06\n60"
  },
  {
    "objectID": "IAR_doc.html#c√°lculo-del-rai",
    "href": "IAR_doc.html#c√°lculo-del-rai",
    "title": "Indice de ¬øabundancia? relativa (RAI)",
    "section": "C√°lculo del RAI",
    "text": "C√°lculo del RAI\nYa cargu√© toda la informaci√≥n que necesito para calcular el RAI, ahora solo tengo que unirla en una base y hacer las operaciones.\nPara ello vamos a aprovecharnos de la capacidad de dplyr para el manejo de bases de datos.\n\nIAR_D0 <- registrosD0 %>%  #Base de datos de registros\n  left_join(Cam_esf) %>%  #Unimos con la base de esfuerzo \n  group_by(Station, Species) %>%  # Agrupamos por cada estaci√≥n y especie\n  summarise(IAR= (n_events*n_events*n_nights_active)/100) # Aplicamos la formula para c√°lcular el RAI y listo\n\nJoining, by = \"Station\"\n`summarise()` has grouped output by 'Station'. You can override using the `.groups` argument.\n\n\nDe esta manera relativamente sencilla podemos obtener el valor de RAI, para cada especie y cada estaci√≥n de muestreo. Tenemos que repetir este procedimiento para cada base de datos de distinto umbral de ‚Äúindependencia‚Äù. Para hacer todo m√°s eficiente voy a crear una peque√±a funci√≥n que me ahorre algo de c√≥digo\n\n#Funci√≥n para RAI r√°pido\nRai_fun <- function(registros, esfuerzo, delta){\n  \n df_RAI <- registros %>% # registros\n    left_join(esfuerzo) %>% # unir con esfuerzo\n    group_by(Station, Species) %>% #agrupar por estacion y sp\n    summarise(IAR = (n_events*n_nights_active)/100) %>%  #Calcular IAR\n    rename_at(., vars(contains(\"IAR\")),list(~paste(\"IAR_D\", delta, sep = \"\") )) # renombrar la columna con el delta adecuado\n   \n  return(df_RAI)\n}\n\n\n# Usemos la peque√±a funci√≥n\n\nIAR_D15 <- Rai_fun(registros = registrosD15,\n                   esfuerzo = Cam_esf,\n                   delta = \"15\")\n\nIAR_D30 <- Rai_fun(registros = registrosD30,\n                   esfuerzo = Cam_esf,\n                   delta = \"30\")\n\nIAR_D60 <- Rai_fun(registros = registrosD60,\n                   esfuerzo = Cam_esf,\n                   delta = \"60\")\n\nAhora juntemos todo en una sola base de datos\n\n# Como todos comparten la columna de especies y de Estacion podemos usar un left_join\nIAR_delta <- IAR_D0 %>% \n  left_join(IAR_D15) %>% \n  left_join(IAR_D30) %>% \n  left_join(IAR_D60) %>% \n  filter(Species %in% c(\"Bassariscus astutus\", #filtro de especies\n                        \"Canis latrans\",\n                        \"Conepatus leuconotus\",\n                        \"Dicotyles angulatus\",\n                        \"Herpailurus yagouaroundi\",\n                        \"Lynx rufus\",\n                        \"Mephitis macroura\",\n                        \"Nasua narica\",\n                        \"Odocoileus virginianus\",\n                        \"Procyon lotor\",\n                        \"Puma concolor\",\n                        \"Spilogale angustifrons\",\n                        \"Sylvilagus floridanus\",\n                        \"Urocyon cinereoargenteus\"\n  ))\n\nJoining, by = c(\"Station\", \"Species\")\nJoining, by = c(\"Station\", \"Species\")\nJoining, by = c(\"Station\", \"Species\")\n\n\n\n\n\n\n\nStation\nSpecies\nIAR\nIAR_D15\nIAR_D30\nIAR_D60\n\n\n\n\nCBG01\nBassariscus astutus\n0\n0\n0\n0\n\n\nCBG01\nCanis latrans\n0\n0\n0\n0\n\n\nCBG01\nConepatus leuconotus\n0\n0\n0\n0\n\n\nCBG01\nDicotyles angulatus\n0\n0\n0\n0\n\n\nCBG01\nHerpailurus yagouaroundi\n0\n0\n0\n0\n\n\nCBG01\nLynx rufus\n0\n0\n0\n0\n\n\n\n\n\nTenemos el RAI por estaci√≥n, pero para evaluarlo gr√°ficamente quiero tener un RAI promedio de especie para todas las c√°maras en cada delta. De nuevo usaremos el poder de dplyr\n\nIAR_mean <- IAR_delta %>% \n  pivot_longer(cols = IAR:IAR_D60, #Pasaran a una columna\n              names_to = \"Delta\", # Esa columna se llamara Delta\n              values_to = \"IAR\") %>% # los valores pasaran a columna llamada IAR\n  group_by(Species, Delta) %>% \n  summarise(mean_IAR= mean(IAR), sd_IAR= sd(IAR)) %>% \n  mutate(Delta= str_remove(Delta, \"IAR_\")) # Solo para quitar ese pedazo de la columna\n\n`summarise()` has grouped output by 'Species'. You can override using the\n`.groups` argument.\n\n\n\nknitr::kable(IAR_mean)\n\n\n\n\nSpecies\nDelta\nmean_IAR\nsd_IAR\n\n\n\n\nBassariscus astutus\nIAR\n5.026774e+00\n1.810406e+01\n\n\nBassariscus astutus\nD15\n3.183871e-01\n8.734380e-01\n\n\nBassariscus astutus\nD30\n3.183871e-01\n8.734380e-01\n\n\nBassariscus astutus\nD60\n3.183871e-01\n8.734380e-01\n\n\nCanis latrans\nIAR\n8.565903e+01\n3.729843e+02\n\n\nCanis latrans\nD15\n8.845161e-01\n1.361873e+00\n\n\nCanis latrans\nD30\n8.845161e-01\n1.361873e+00\n\n\nCanis latrans\nD60\n8.845161e-01\n1.361873e+00\n\n\nConepatus leuconotus\nIAR\n8.259581e+01\n1.758284e+02\n\n\nConepatus leuconotus\nD15\n1.519032e+00\n2.324736e+00\n\n\nConepatus leuconotus\nD30\n1.519032e+00\n2.324736e+00\n\n\nConepatus leuconotus\nD60\n1.519032e+00\n2.324736e+00\n\n\nDicotyles angulatus\nIAR\n1.158646e+04\n5.513660e+04\n\n\nDicotyles angulatus\nD15\n3.083226e+00\n7.880741e+00\n\n\nDicotyles angulatus\nD30\n3.023226e+00\n7.728507e+00\n\n\nDicotyles angulatus\nD60\n2.903226e+00\n7.195641e+00\n\n\nHerpailurus yagouaroundi\nIAR\n1.935480e-02\n1.077632e-01\n\n\nHerpailurus yagouaroundi\nD15\n1.935480e-02\n1.077632e-01\n\n\nHerpailurus yagouaroundi\nD30\n1.935480e-02\n1.077632e-01\n\n\nHerpailurus yagouaroundi\nD60\n1.935480e-02\n1.077632e-01\n\n\nLynx rufus\nIAR\n4.813516e+01\n8.505259e+01\n\n\nLynx rufus\nD15\n1.341935e+00\n1.557711e+00\n\n\nLynx rufus\nD30\n1.341935e+00\n1.557711e+00\n\n\nLynx rufus\nD60\n1.341935e+00\n1.557711e+00\n\n\nMephitis macroura\nIAR\n3.024968e+01\n1.039956e+02\n\n\nMephitis macroura\nD15\n6.532258e-01\n1.812369e+00\n\n\nMephitis macroura\nD30\n6.532258e-01\n1.812369e+00\n\n\nMephitis macroura\nD60\n6.532258e-01\n1.812369e+00\n\n\nNasua narica\nIAR\n1.598290e+01\n6.918818e+01\n\n\nNasua narica\nD15\n2.364516e-01\n5.610380e-01\n\n\nNasua narica\nD30\n2.364516e-01\n5.610380e-01\n\n\nNasua narica\nD60\n2.167742e-01\n4.869866e-01\n\n\nOdocoileus virginianus\nIAR\n9.049558e+03\n2.396276e+04\n\n\nOdocoileus virginianus\nD15\n9.293226e+00\n1.111770e+01\n\n\nOdocoileus virginianus\nD30\n9.233548e+00\n1.101366e+01\n\n\nOdocoileus virginianus\nD60\n9.034516e+00\n1.071171e+01\n\n\nProcyon lotor\nIAR\n1.359355e+01\n4.141367e+01\n\n\nProcyon lotor\nD15\n4.751613e-01\n9.455541e-01\n\n\nProcyon lotor\nD30\n4.751613e-01\n9.455541e-01\n\n\nProcyon lotor\nD60\n4.751613e-01\n9.455541e-01\n\n\nPuma concolor\nIAR\n8.000000e-02\n4.454211e-01\n\n\nPuma concolor\nD15\n2.000000e-02\n1.113553e-01\n\n\nPuma concolor\nD30\n2.000000e-02\n1.113553e-01\n\n\nPuma concolor\nD60\n2.000000e-02\n1.113553e-01\n\n\nSpilogale angustifrons\nIAR\n2.216129e+00\n8.767499e+00\n\n\nSpilogale angustifrons\nD15\n2.541935e-01\n6.359862e-01\n\n\nSpilogale angustifrons\nD30\n2.541935e-01\n6.359862e-01\n\n\nSpilogale angustifrons\nD60\n2.541935e-01\n6.359862e-01\n\n\nSylvilagus floridanus\nIAR\n4.825027e+03\n1.421554e+04\n\n\nSylvilagus floridanus\nD15\n9.537419e+00\n1.380820e+01\n\n\nSylvilagus floridanus\nD30\n9.204194e+00\n1.332017e+01\n\n\nSylvilagus floridanus\nD60\n8.812903e+00\n1.257965e+01\n\n\nUrocyon cinereoargenteus\nIAR\n2.770174e+03\n8.731199e+03\n\n\nUrocyon cinereoargenteus\nD15\n8.730323e+00\n1.379761e+01\n\n\nUrocyon cinereoargenteus\nD30\n8.671290e+00\n1.372938e+01\n\n\nUrocyon cinereoargenteus\nD60\n8.554516e+00\n1.332033e+01\n\n\n\n\n\nAhora vamos a verlo de manera gr√°fica\n\n(IARmean_plot <- IAR_mean %>% # base de datos\n  filter(Delta != \"IAR\") %>% # Quitar delta 0 para gr√°fica\n  ggplot(aes(x= reorder(Delta, -mean_IAR) , y= mean_IAR,  group=1))+ # Datos de los ejes\n  geom_line()+ # Linea\n  geom_point(aes(col= Delta), \n             size= 3)+ # Puntos\n  facet_wrap(.~Species, scales = \"free\")+ # Hacerlo por especie\n  labs(y= \"Media de IAR\", \n       x= \"Delta de de tiempo de registros\",\n       caps= \"Sin D0\")+\n  theme_bw()) # Tema\n\n\n\n\nComo ven no a todas las especies las afecta igual el umbral de independencia. Hay algunas especies cuyos registros son tan dispersos en el muestreo, que el RAI no cambia con ning√∫n umbral de independencia.\nClaro, esta gr√°fica te ayudar√° a guiarte, pero debe ir acompa√±ada de una observaci√≥n de los registros o el c√°lculo de la autocorrelaci√≥n temporal para definir el ‚Äúdelta‚Äù de tiempo que usaras. Ya estamos trabajando en este √∫ltimo punto y espero en alg√∫n futuro cercano poner en linea un tutorial para estimar el umbral de independencia temporal. Por ahora me quedar√© con los registros con un delta de 15 minutos.\nAhora veamos los valores de RAI por especie\n\nplot_IAR <- IAR_mean %>%\n  filter(Delta == \"D15\") %>% \n  mutate(Sp_n= paste(\"*\",Species,\"*\", \" (IAR= \",round(mean_IAR, 3) , \" ) \", sep = \"\") ) %>% # Truco para italica de especies\n  ggplot(aes(x= reorder(Sp_n,mean_IAR), #Ordenar sp \n                              y= mean_IAR))+ # No. eventos\n   geom_bar(stat= \"identity\")+  # Geometria\n      coord_flip()+ # Girar ejes\n   labs(title = \"IAR de especies\", # T√≠tulo\n        y= \"IAR calculado\", \n        x= NULL,\n        caption = \"Registros  independencia temporal de 15 minutos a√±o 2020\")+ # Sin eje x\n   theme_minimal()+ # Tema\n   theme(axis.text.y= element_markdown()) # It√°lica nombre de especies\n plot_IAR \n\n\n\n\nRecordemos que este gr√°fico es informativo y que no es recomendable comparar el RAI de diferentes especies. Por ejemplo, no sabemos si hay m√°s venados que zorras grises (probablemente no), solo sabemos que los venados son m√°s frecuentemente fotografiados. Hablando de venados, aprovechemos que es una especie con bastantes datos y evaluemos por medio de modelos la relaci√≥n de su RAI con algunas variables."
  },
  {
    "objectID": "IAR_doc.html#modelando-el-rai",
    "href": "IAR_doc.html#modelando-el-rai",
    "title": "Indice de ¬øabundancia? relativa (RAI)",
    "section": "Modelando el RAI ü¶å",
    "text": "Modelando el RAI ü¶å\nEn este caso lo que nos interesa conocer es c√≥mo la variaci√≥n del RAI es explicada por distintas condiciones del sitio, vamos a usar nuestra base cruda de delta 15, no la del promedio.\n\nvenado <- IAR_D15 %>% # Llamamos la base de datos\n  filter(Species == \"Odocoileus virginianus\") # Filtramos la especie que nos interesa \n\nAhora vamos a cargar las variables, escalarlas y finalmente unirlas a la base de IAR\n\ncovs.data <- read_csv2(\"Data/selectedcov_nostd190821.csv\")\n\ni Using \"','\" as decimal and \"'.'\" as grouping mark. Use `read_delim()` for more control.\n\n\nRows: 31 Columns: 12\n-- Column specification --------------------------------------------------------\nDelimiter: \";\"\nchr (5): Station, Cam, MSAVI, Slope, Habitat\ndbl (4): utm_y, utm_x, Cluster, Effort\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# UPS hay dos variables numericas que R las lee como caracteres\ncovs.data$MSAVI <- as.numeric(covs.data$MSAVI)\ncovs.data$Slope <- as.numeric(covs.data$Slope)\n\n### Separar las variables num√©ricas y categ√≥ricas\ncov.num <- covs.data %>% \n  dplyr::select(where(is.numeric)) %>% # Seleccionar columnas num√©ricas\n  scale() %>%  # estandarizar\n  as.data.frame()\ncov.fac <- covs.data %>% \n  dplyr::select(where(is.character)) # Seleccionar variables de caracter\nsp_lmdata <- data.frame(cov.fac, cov.num) %>% # Unir covariables\n  right_join(venado, by= \"Station\")# Unir con la base de registros\n\nAl tomar el IAR valores continuos suponemos que seguir√° un error tipo gaussiano, por lo cual usaremos modelos lineales simples para modelarlo. NOTA: Al no tomar valores negativos quiz√°s pueda ser error tipo gamma pero depende de cada quien probarlo.\n\n# Modelos lineales \n# sin variables\nm0 <- lm(IAR_D15~ 1, data = sp_lmdata)\n# la IAR afectada por la distancia a cultivo\nm1 <- lm(IAR_D15~ Dcrops, data = sp_lmdata)\n# la IAR afectada por el verdor de la vegetaci√≥n\nm2 <- lm(IAR_D15~ MSAVI, data = sp_lmdata)\n# la IAR afectada por la pendiente\nm3 <- lm(IAR_D15~ Slope, data = sp_lmdata) \n# la IAR afectada por la distancia a poblados\nm4 <- lm(IAR_D15~ Dpop_G, data = sp_lmdata)\n# la IAR afectada por el tipo de habitat\nm5 <- lm(IAR_D15~ Habitat, data = sp_lmdata)\n\nUsaremos el criterio de informaci√≥n de Akaike (AIC) para seleccionar el ‚Äúmejor‚Äù modelo. Consiedaremos modelos con un delta AIC menor a dos como igualmente plausibles (Burnham and Anderson 2002).\n\nlista_mods <- list(m0, m1, m2, m3, m4, m5)\nmod_names <- c(\"IAR~ 1\",\n               \"IAR~ D_cultivos\",\n               \"IAR~ MSAVI\",\n               \"IAR~ Slope\",\n               \"IAR~ D_poblado\",\n               \"IAR~ Habitat\"\n               )\nAIC <- aictab(lista_mods, \n              modnames = mod_names, \n              second.ord = F, sort = T)\nknitr::kable(AIC, 'html', digits = 3)\n\n\n\n \n  \n      \n    Modnames \n    K \n    AIC \n    Delta_AIC \n    ModelLik \n    AICWt \n    LL \n    Cum.Wt \n  \n \n\n  \n    4 \n    IAR~ Slope \n    3 \n    230.608 \n    0.000 \n    1.000 \n    0.949 \n    -112.304 \n    0.949 \n  \n  \n    6 \n    IAR~ Habitat \n    3 \n    237.783 \n    7.175 \n    0.028 \n    0.026 \n    -115.892 \n    0.976 \n  \n  \n    2 \n    IAR~ D_cultivos \n    3 \n    239.582 \n    8.974 \n    0.011 \n    0.011 \n    -116.791 \n    0.986 \n  \n  \n    1 \n    IAR~ 1 \n    2 \n    240.287 \n    9.679 \n    0.008 \n    0.008 \n    -118.144 \n    0.994 \n  \n  \n    3 \n    IAR~ MSAVI \n    3 \n    241.791 \n    11.183 \n    0.004 \n    0.004 \n    -117.896 \n    0.997 \n  \n  \n    5 \n    IAR~ D_poblado \n    3 \n    242.287 \n    11.678 \n    0.003 \n    0.003 \n    -118.143 \n    1.000 \n  \n\n\n\n\n\nSeg√∫n el AIC la pendiente es la variable que mejor explica los cambios en RAI del venado en nuestra √°rea de estudio. Veamos los coeficientes del modelo.\n\nmodelo <- m3 %>% \n  tidy()\n\nknitr::kable(modelo, digits = 3)\n\n\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n9.293\n1.682\n5.524\n0.000\n\n\nSlope\n6.229\n1.710\n3.643\n0.001\n\n\n\n\n\n\npred <- ggeffect(m3, terms= \"Slope\")\nplot(pred)\n\n\n\n\nAlto ah√≠ vaquero. El AIC no te indica que tu modelo se adecuado, as√≠ que es deber de nosotros verificar que cumple con todos los supuestos.\n\ncheck_model(m3)\n\n\n\n\nParece que nuestro modelito no cumple del todo con el supuesto de normalidad en los residuales, tiene heterogeneidad en su varianza y tambi√©n una posible outlier. Por ahora no nos preocuparemos mucho por esto; primero porque es un ejemplo y segundo porque para serles sincero yo invent√© las covariables üòùü§™. Lo que quiero que vean es que a pesar de todo el RAI te puede dar una idea de la relaci√≥n del h√°bitat con las especies. Claro, estamos subestimando la relaci√≥n por el hecho de no considerar la detecci√≥n imperfecta, pero mientras seamos conscientes de ello y lo discutamos, personalmente creo que sigue siendo valioso."
  },
  {
    "objectID": "Diversidad Congreso.html",
    "href": "Diversidad Congreso.html",
    "title": "Introduci√≥n al an√°lisis de diversidad taxon√≥mica",
    "section": "",
    "text": "La diversidad de especies es una de las medidas m√°s comunes e importantes en la ecolog√≠a, pero as√≠ mismo dif√≠cil de cuantificar. La importancia en la cuantificaci√≥n de la diversidad taxon√≥mica ha resultado en que en la √∫ltima d√©cada se hayan generado grandes avances (Jost 2006a; Chao and Jost 2012; Chao et al. 2014). Tanto que a veces parece abrumador la cantidad de indices, estimadores y maneras en la que se eval√∫a la diversidad. Tranquilo, hoy vamos a intentar aprender el c√≥mo y porqu√© de algunas de las aproximaciones m√°s comunes para cauntificar la diversidad taxon√≥mica de especies.\n\n\n\nThe Wash Walker by pine.bones"
  },
  {
    "objectID": "Diversidad Congreso.html#la-riqueza-de-especies",
    "href": "Diversidad Congreso.html#la-riqueza-de-especies",
    "title": "Introduci√≥n al an√°lisis de diversidad taxon√≥mica",
    "section": "La riqueza de especies",
    "text": "La riqueza de especies\nLa riqueza o el n√∫mero de especies es la medida m√°s sencilla de diversidad. Cualquiera que haya visto alg√∫n curso de ecolog√≠a de comunidades se habr√° embarcado en la aventura de medir y comparar la riqueza de especies. Es muy sencillo: cuantas especies hay en determinado espacio y tiempo, ¬øQu√© podr√≠a salir mal?\nA pesar de ser una m√©trica muy intuitiva de la comunidad, la riqueza de especies tambi√©n es dif√≠cil de medir. ¬øPorque?. Resulta que cuando salimos a campo, ponemos nuestras c√°maras y obtenemos nuestros datos, lo que realmente tenemos es una muestra de las especies detectadas. Pero no necesariamente todas las especies de la comunidad.\n\n\n\nImagina que M son todas las especies que existen en la comunidad y N son las que detectamos en nuestro muestreo\n\n\n\nEstimar la riqueza\nPara conocer la riqueza real necesitamos saber cuantas especies aun no han sido detectadas\n\\[\nRiqueza-real= riqueza-registrada+riqueza-no-detectada\n\\]"
  },
  {
    "objectID": "Diversidad Congreso.html#curvas-de-rarefacci√≥n",
    "href": "Diversidad Congreso.html#curvas-de-rarefacci√≥n",
    "title": "Introduci√≥n al an√°lisis de diversidad taxon√≥mica",
    "section": "Curvas de rarefacci√≥n",
    "text": "Curvas de rarefacci√≥n\nLas curvas de rarefacci√≥n se basan en las curvas de acumulaci√≥n de especies. La l√≥gica de las curva de acumulaci√≥n es tomar un individuo al azar de la muestra y registrar la especie. Repetimos el proceso varias veces, y en cada ocasi√≥n vamos agregando nuevas especies o no. Lo que esperar√≠amos es que a medida de que tomamos mas unidades de muestreo o individuos tendremos m√°s especies hasta el punto en donde a pesar de agregar m√°s individuos o sitios de muestreo no tendremos m√°s especies. En ese punto alcanzaremos la asintota de la riqueza. Estas curvas nos pueden dar informaci√≥n muy interesante sobre la comunidad. Por ejemplo, una curva que que tenga una pendiente muy pronunciada nos habla de una comunidad con especies con distribuci√≥n de la abundancia similar. Mientras que una curva con una pendiente que cae r√°pidamente sugiere que la comunidad esta dominada por ciertas especies (Gotelli and Colwell 2011).\n\nEn teor√≠a podemos agregar individuos o muestras hasta que ya no se detecten nuevas especies, es decir que, se llega a la riqueza asint√≥tica. Sin embargo, en la realidad no siempre tenemos la capacidad log√≠stica para llegar hasta la as√≠ntota (especialmente en los tr√≥picos y depender√° del grupo de organismos).\nUn limitante de las curva de acumulaci√≥n es que su pendiente puede variar dependiendo del orden en que se agregan los individuos, as√≠ que una soluci√≥n es la rarefacci√≥n. B√°sicamente la rarefacci√≥n es un re-muestreo sin remplazo, donde se van tomando individuos al azar y se registra cada especie. Esta t√©cnica permite tambi√©n obtener intervalos de confianza al 95% lo que permite hacer comparaciones de la riqueza de especies de dos comunidades con distintas abundancias de individuos (siempre y cuando sean los mismos organismos y los mismos m√©todos).\nVamos a generar nuestras curvas de rarefacci√≥n usando las funciones de vegan (Oksanen et al. 2020).\n\nCargar datos\nVamos a cargar datos de c√°maras trampa que obtenemos a partir de camtrapR. Debido a que los datos consideran humanos y otros grupos como aves o reptiles, vamos a filtrar las especies que nos interesan.\n\n# Registros con independencia de 15 min\nregistrosD15 <- read.csv(\"Data/events_by_station_d15.csv\") %>% filter(Species %in% c(\"Bassariscus astutus\", #filtro de especies\n                        \"Canis latrans\",\n                        \"Conepatus leuconotus\",\n                        \"Dicotyles angulatus\",\n                        \"Herpailurus yagouaroundi\",\n                        \"Lynx rufus\",\n                        \"Mephitis macroura\",\n                        \"Nasua narica\",\n                        \"Odocoileus virginianus\",\n                        \"Procyon lotor\",\n                        \"Puma concolor\",\n                        \"Spilogale angustifrons\",\n                        \"Sylvilagus floridanus\",\n                        \"Urocyon cinereoargenteus\"\n  ))\nCT_table <- read.delim(\"Data/CT_cams.txt\")\n\nVamos a realizar una peque√±a gr√°fica para darnos una idea de como se distribuye la riqueza de especies en nuestra √°rea de estudio. Hay que hacer un poco de carpinter√≠a de datos:\n\nN_spec <- registrosD15 %>% #los datos\n  filter(n_events > 0) %>% # filtro solo sitios con detecciones\n  group_by(Station) %>% #agrupamos por c√°mara\n  tally() %>% # Contamos las especies por c√°mara\n  left_join(CT_table) %>% #agregamos las coordenadas\n  select(Station, utm_x, utm_y, n) #seleccionamos columnas\n\n\nggplot(N_spec, aes(x= utm_x, y=utm_y))+\n  geom_point(aes(size=n, col=n),\n             alpha= 0.8)+\n  scale_size(range = c(1,15))+ # Escala del radio para los puntos\n  labs(title= \"Mapa de n√∫mero especies\",\n       y= \"Lat\",\n       x= \"Lon\",\n       size= \"N√∫mero de \\nespecies\",\n       col=NULL)+\n  theme_bw()\n\n\n\n\nAhora vamos por las curvas. Primero tenemos que hacer m√°s carpinteria de datos para ajustar el formato que requiere la funci√≥n specaccum. B√°sicamente necesitamos una matriz donde las especies sean las columnas y las filas, cada una de las unidades de muestreo.\n\nac_data <- registrosD15 %>% # datos\n  pivot_wider(names_from = Species, # nuevas columnas\n              values_from = n_events) %>% # valores\n  column_to_rownames(var= \"Station\")# columna a nombre de filas\n\n# Funci√≥n de vegan specaccum para las curvas de acumulaci√≥n\nsample <- specaccum(ac_data, # datos\n                   method = \"random\", # basado en muestreo\n                   permutations = 100)[c(3,4,5)] %>% #seleccionar objetos de la lista\n  reduce(bind_cols) %>% # Unirlos en un data.frame\n  rename(Sitios= \"...1\", # Renombrar columnas\n         Riqueza= \"...2\",\n         SD= \"...3\")\n\nindi <- specaccum(ac_data, \n                  method = \"rarefaction\", # basado en individuos\n                  permutations = 100)[c(4,5,7)] %>% \n  reduce(bind_cols) %>% # Unirlos en un data.frame\n  rename(Riqueza= \"...1\", # Renombrar columnas\n         SD= \"...2\",\n         Individuos= \"...3\")\n\n# Grafica de las curvas\nggplot(sample, aes(x=Sitios, y=Riqueza, \n                  ymin= Riqueza-SD,\n                  ymax= Riqueza+SD))+\n  geom_ribbon(alpha=0.5)+\n  geom_line(size=1)+\n  labs(title = \"Curva de rarefaccion basada en muestreo\",\n       y= \"Riqueza acumulada\",\n       x= \"Unidades de muestreo\")+\n  theme_bw()\nggplot(indi, aes(x=Individuos, y=Riqueza, \n                  ymin= Riqueza-SD,\n                  ymax= Riqueza+SD))+\n  geom_ribbon(alpha=0.5)+\n  geom_line(size=1)+\n  labs(title = \"Curva de rarefaccion basada en individuos\",\n       y= \"Riqueza acumulada\",\n       x= \"Individuos\")+\n  theme_bw()\n\n\n\n\n\n\n\n\n\n\n\n\n\nSupuestos de las curvas para comparar comunidades\n\nEl poder para detectar diferencias estad√≠sticas requiere suficiente informaci√≥n. En el caso del fototrampeo al menos se ha detectado que con 30 a 60 d√≠as de muestreo con 25 a 60 c√°maras es suficiente para recuperar la riqueza de especies (Kays et al. 2020).\nDiferentes m√©todos pueden tener capacidades disintitas para detectar ciertas especies, por lo cual es peligroso comparar comunidades diferentes mediante m√©todos de muestreo diferentes. Pese a ello, autores han usado esta t√©cnica para compara la eficacia de m√©todos sobre la misma √°rea. Tambi√©n se han conjugado diferentes m√©todos para maximizar la detecci√≥n de especies, pero si se comparan otro sitio se deben usar las mismas especificaciones (Gotelli and Colwell 2011).\nLas comunidades que se comparan deber ser de especies taxon√≥micamente similares.\nLa comunidad debe ser ‚Äúestable‚Äù al menos durante el muestreo. Adem√°s, las especies deben ser organismos plenamente identificados y cuantificables.\nMuestreo aleatorio con unidades independientes."
  },
  {
    "objectID": "Diversidad Congreso.html#estimadores-no-param√©tricos",
    "href": "Diversidad Congreso.html#estimadores-no-param√©tricos",
    "title": "Introduci√≥n al an√°lisis de diversidad taxon√≥mica",
    "section": "Estimadores no param√©tricos",
    "text": "Estimadores no param√©tricos\nLos estimadores no param√©tricos son quiz√°s los m√°s usados para estimar la riqueza de especies. El termino no parm√©trico se refiere a que estos estimadores no requieren ajustarse ning√∫n modelo te√≥rico .(Pineda-L√≥pez 2019). Dado que los estimadores param√©tricos han demostrado tener complicaciones al estimar la riqueza, los no estimadores no param√©tricos se han vuelto los consentidos(Gotelli and Colwell 2011).\nPodemos usar diferentes estimadores dependiendo si nuestros datos son de incidencia (frecuencia) o de abundancia. Si tienes de abundancia, siempre se puede convertir en incidencia, pero no viceversa (Gotelli and Colwell 2011) .\n\nIncidencia: Chao2, ICE, Jacknifes de incidencia y bootstrap\nAbundancia: Chao1, ACE, Jacknifes de abundancia\n\nPor espacio no pondr√© las formulas de cada estimador, pero es bueno que cada quien las consulte (Gotelli and Colwell 2011; C. Moreno 2001).\nB√°sicamente estos estimadores corrigen la riqueza observada (Sobs) mediante las especies que solo son representadas por un individuo (singletons) o dos (doubletons) en el caso de datos de abundancia. Para incidencia especies con frecuencia uno (uniques) y (duplicates). ¬øC√≥mo lo hacen? estos estimadores se basan el principio de la ecuaci√≥n de Turing y Good (Good 1953), es decir que, las informaci√≥n de las especies m√°s raras puede ser usada para estimar cuantas especies faltan.\n\n\n\nAlan Turing: https://tecreview.tec.mx/wp-content/uploads/2018/10/alan-t.jpg\n\n\n\nVegan\nVamos a calcular estos estimadores usando las funciones de vegan (Oksanen et al. 2020). El mismo vegan tiene funciones de plot y summary utiles para resumir la informaci√≥n. Sin embargo, como tengo m√°s habilidades con ggplo2, lo que haremos ser√° carpinter√≠a de datos para poder gratificarlo como queremos\n\ncolumnas <- c(\"N\", \"S\", \"2.5%\", \"97.5%\", \"Std.Dev\") # Cambiiar los nombres de las columnas en incidencia\n\nincidence <-  poolaccum(ac_data, permutations = 100) %>% \n  summary() %>% #Generar el resumen\n  map(as.data.frame) %>% # Hacer cada objeto un data.frame\n  map(., setNames, nm = columnas) %>% # Cambiar nombres\n  reduce(bind_rows) %>% # Unir todo en un data.frame\n  mutate(Estimador= rep(c(\"S\", \"Chao\", \"Jack1\", \"Jack2\", \"boot\"), \n                        each= 29)) %>% # Agregar una columna con \n  mutate_if(is.numeric, round, 2) #Redondear a dos cifras\n\n# Con los de abundancia es m√°s sencillo\nabundance <- estaccumR(ac_data, permutations = 100) %>%\n   map(as.data.frame) %>% # Hacer cada objeto un dataframe\n  .[[\"means\"]] %>% # Seleccionar solo las medias\n  pivot_longer(cols = S:ACE, # Cambiar a formato largo\n               names_to = \"Estimador\",\n               values_to = \"S\") %>% \n  mutate_if(is.numeric, round, 2)\n  \n\n\nggplot(incidence, aes(x=N, y=S, col= Estimador))+\n  geom_line(size=1)+\n  scale_y_continuous(sec.axis = \n                       sec_axis(~ ., breaks = incidence %>% filter(N==31) %>%  pull(S)))+ # Crear un segundo eje con los √∫ltimos valores\n  labs(title = \"Estimadores basados en incidencia\",\n       y= \"Riqueza acumulada\",\n       x= \"Unidades de muestreo\")+\n  theme_bw()\n\n\n\nggplot(abundance, aes(x=N, y=S, col= Estimador))+\n  geom_line(size=1)+\n  scale_y_continuous(sec.axis = \n                       sec_axis(~ ., \n                                breaks = abundance %>% filter(N==31) %>%  pull(S)))+\n  labs(title = \"Estimadores basados en abundancia\",\n       y= \"Riqueza acumulada\",\n       x= \"Unidades de muestreo\")+\n  theme_bw()\n\n\n\n\n\n\nSpadeR\nAhora vamos a usar el paquete SpadeR creado por Anne Chao (Chao et al. 2016). Este paquete tiene una serie de funciones para estimar varios indices de diversidad y de riqueza, incluyendo algunos m√°s recientes como iChao (Chiu et al. 2014). iChao b√°sicamente incluye los tripletons y quadrupletons para mejorar la estimaci√≥n de la riqueza.\nPrimero vamos a tener que ajustar nuestra base de datos al formato que requiere SpadeR: cada fila es una especie y una sola columna (por comunidad) donde van nuestras abundancias.\n\nSpader_df <- ac_data %>% # Datos\n  t() %>% # Transponer los datos\n  as.data.frame() %>% # De nuevo a data.frame\n  rowSums() %>% #Sumar las abundancias\n  as.data.frame() %>% # De nuevo a data frame\n  rename(abun= \".\") %>% # Nombre de la columna\n  arrange(desc(abun)) %>% # ordenar los valores\n  as.matrix() # Requiere formato de matriz\n\nknitr::kable(Spader_df)\n\n\n\n\n\nabun\n\n\n\n\nSylvilagus floridanus\n486\n\n\nOdocoileus virginianus\n471\n\n\nUrocyon cinereoargenteus\n444\n\n\nDicotyles angulatus\n155\n\n\nConepatus leuconotus\n77\n\n\nLynx rufus\n68\n\n\nCanis latrans\n45\n\n\nMephitis macroura\n33\n\n\nProcyon lotor\n24\n\n\nBassariscus astutus\n16\n\n\nSpilogale angustifrons\n13\n\n\nNasua narica\n12\n\n\nHerpailurus yagouaroundi\n1\n\n\nPuma concolor\n1\n\n\n\n\n\nAhora si usamos la funci√≥n de ChaoSpecies . NOTA: uso SpadeR:: para especificarle a R que llamo la funci√≥n de dicho paquete. √âsto debido a que cuando cargas iNEXT en el mismo script la funci√≥n puede generar conflictos\n\nSpad_est <- SpadeR::ChaoSpecies(Spader_df,\n                        datatype = \"abundance\")\n\nWarning: In this case, it can't estimate the variance of Homogeneous estimation \n\n\nVamos a inspeccionar que hay dentro de el objeto que generamos.\nPrimero tenemos la tabla de informaci√≥n b√°sica con el tama√±o de la muestra, n√∫mero de especies, cobertura de la muestra ( lo veremos en detalle en la secci√≥n de diversidad), el coeficiente de variaci√≥n (CV). El CV te da una medida de la heterogeneidad de la abundancia de especies, donde 0 quiere decir que todas las especies tienen la mismas abundancias o la misma probabilidad de ser descubiertas. Toda la informaci√≥n detallada se puede encontrar en la gu√≠a del paquete en la p√°gina web de Anne Chao\n\nknitr::kable(Spad_est[[\"Basic_data_information\"]])\n\n\n\n\n\nVariable\nValue\n\n\n\n\nSample size\nn\n1846\n\n\nNumber of observed species\nD\n14\n\n\nCoverage estimate for entire dataset\nC\n0.999\n\n\nCV for entire dataset\nCV\n1.36\n\n\nCut-off point\nk\n10\n\n\nNumber of observed individuals for rare group\nn_rare\n2\n\n\nNumber of observed species for rare group\nD_rare\n2\n\n\nEstimate of the sample coverage for rare group\nC_rare\n0\n\n\nEstimate of CV for rare group in ACE\nCV_rare\n0\n\n\nEstimate of CV1 for rare group in ACE-1\nCV1_rare\n0\n\n\nNumber of observed individuals for abundant group\nn_abun\n1844\n\n\nNumber of observed species for abundant group\nD_abun\n12\n\n\n\n\n\nAhora veremos el otro objeto que contiene las estimaciones de varios √≠ndices y sus correspondientes intervalos de confianza.\n\nSpd_rest <- Spad_est[[\"Species_table\"]] %>% \n  as.data.frame() %>% # transformar a dataframe\n  rownames_to_column(var= \"Indice\") %>% # hacer columna\n  drop_na() # Quitar NAS del modelo heterogeneo\nknitr::kable(Spd_rest, digits = 2)\n\n\n\n\nIndice\nEstimate\ns.e.\n95%Lower\n95%Upper\n\n\n\n\nHomogeneous (MLE)\n14\n0.68\n14.00\n16.19\n\n\nChao1 (Chao, 1984)\n15\n2.29\n14.07\n28.17\n\n\nChao1-bc\n15\n2.29\n14.07\n28.17\n\n\niChao1 (Chiu et al.¬†2014)\n15\n2.29\n14.07\n28.17\n\n\nACE (Chao & Lee, 1992)\n15\n2.29\n14.07\n28.17\n\n\nACE-1 (Chao & Lee, 1992)\n15\n2.29\n14.07\n28.17\n\n\n1st order jackknife\n16\n2.00\n14.39\n24.22\n\n\n2nd order jackknife\n18\n3.46\n14.92\n31.32\n\n\n\n\n\nAhora veamoslo de manera gr√°fica\n\nggplot(Spd_rest, aes(x=Indice, y= Estimate,\n                     ymin= `95%Lower`, ymax=`95%Upper`))+\n  geom_pointrange(aes(col=Indice), size= 1)+\n  geom_hline(yintercept = 14)+\n  labs(x= NULL,\n       y= \"Riqueza de especies\")+\n  coord_flip()+\n  theme_bw()+\n  theme(legend.position = \"none\")\n\n\n\n\n¬øCon cu√°l indice deber√≠amos quedarnos? A trav√©s de simulaciones y pruebas se han dado cuenta que no hay un indice que funcione mejor que otros constantemente, pues su desempe√±o depende de los datos (Gwinn et al. 2015). Por ejemplo, los Jacknifes tienden a sobrestimar con tama√±os de muestra grandes, pero a subestimar en datos con bajos esfuerzos de muestreo. Lo que parece pasar en nuestro data set (Chiu et al. 2014). Chao and Chiu (2016) tambi√©n menciona que los estimadores Chao tienden a representar el intervalo menor de la riqueza ‚Äúverdadera‚Äù, salvo cuando hay muy pocas especies raras. Cuando hay demasiadas especies raras los iChao tienden a tener mejores resultados dado que incluyen tripletons y quadrupletons(Chao and Colwell 2017; Pineda-L√≥pez 2019).\n\n\nCompletitud de la muestra\nOtra medida derivada de los estimadores no param√©tricos es la de la completitud de la muestra. La completitud de la muestra nos da una medida de que tan completo es tu muestreo, basado en que a mayor esfuerzo menor n√∫mero de singletons o doubletos. Al menos cuando yo aprend√≠ de los estimadores de riqueza era una medida obligator√≠a de reportar y se calculaba as√≠:\n\\[\nCompletitud= \\frac{Sobs}{R_estimada} *100\n\\]\n\ncomple <- Spd_rest %>% \n  mutate(Completitud= (14/Estimate)*100) %>% \n  select(Indice, Estimate,Completitud)\nknitr::kable(comple, digits = 2)\n\n\n\n\nIndice\nEstimate\nCompletitud\n\n\n\n\nHomogeneous (MLE)\n14\n100.00\n\n\nChao1 (Chao, 1984)\n15\n93.34\n\n\nChao1-bc\n15\n93.34\n\n\niChao1 (Chiu et al.¬†2014)\n15\n93.34\n\n\nACE (Chao & Lee, 1992)\n15\n93.34\n\n\nACE-1 (Chao & Lee, 1992)\n15\n93.34\n\n\n1st order jackknife\n16\n87.51\n\n\n2nd order jackknife\n18\n77.79\n\n\n\n\n\nAlgunos autores sugieren que un porcentaje de completitud mayor al 80% indica un muestreo representativo (Lobo 2008). Es importante no confundir la completitud del muestreo con la cobertura de la muestra. Esta √∫ltima representa la proporci√≥n de la abundancia, mientras que como vimos la completitud se basa solo en el n√∫mero de especies estimado vs el observado."
  },
  {
    "objectID": "Diversidad Congreso.html#curvas-rango-abundancia",
    "href": "Diversidad Congreso.html#curvas-rango-abundancia",
    "title": "Introduci√≥n al an√°lisis de diversidad taxon√≥mica",
    "section": "Curvas rango abundancia",
    "text": "Curvas rango abundancia\nEn un principio hablamos que la diversidad tenia que ver con tres elementos: la riqueza, la abundancia y la composici√≥n (esta √∫ltima no la veremos en detalle). Hasta ahora nos enfocamos en la riqueza y aunque evaluamos la influencia del n√∫mero de individuos sobre ella, no hemos entrado en detalle sobre la estructura de la abundancia de cada entidad.\n\n\n\nfuente: https://www.unpri.org/biodiversity/investor-action-on-biodiversity-discussion-paper/6335.article\n\n\nEn una comunidad no todas las especies tienen el mismo ‚Äúaporte‚Äù, es decir hay algunas que son muy ‚Äúabundantes‚Äù y otras bastante ‚Äúraras‚Äù. La estructura de la abundancia de las especies y su determinada pueden sugerir procesos ecol√≥gicos como disturbios, interacciones o capacidad de carga. Una de las maneras m√°s sencillas de explorar el comportamiento de la estructura de la abundancia es mediante curvas rango-rango abundancia. En esta gr√°fica lo que hacemos es reankear las especies por su abundancia (o log de abundancia). Esto es relativamente sencillo de construir con la funci√≥n rankabundance de BiodiversityR (Kindt and Coe 2005)\n\nRA<-rankabundance(ac_data) %>% # Funci√≥n de rango abundancia\n  as.data.frame() %>% \n  rownames_to_column(var= \"Especies\")\n\n\nggplot(RA, aes(x=rank, y=logabun))+\n  geom_line(size= 1)+\n  geom_point(aes(col= Especies),size = 3)+\n  geom_text_repel(aes(label=Especies),\n                  box.padding = 1,\n                  colour= \"black\", angle=25,size= 3)+\n  theme_bw()+\n  labs(x = \"rank\", y = \"log abundance\", size= 14)+\n  theme(legend.position = \"none\")\n\n\n\n\nLa pendiente de la curva nos dar√° una idea de que tan equitativa puede ser una comunidad: Una curva m√°s aplanada nos dice que las especies tienden a tener abundancias similares (mayor equitatividad), mientras que una curva pronunciada probablemente se deba a unas cuantas especies muy dominantes."
  },
  {
    "objectID": "Diversidad Congreso.html#estimadores-de-diversidad",
    "href": "Diversidad Congreso.html#estimadores-de-diversidad",
    "title": "Introduci√≥n al an√°lisis de diversidad taxon√≥mica",
    "section": "Estimadores de diversidad",
    "text": "Estimadores de diversidad\nEl √≠ndice de Shannon o Simpson (SIMPSON 1949; Sherwin et al. 2017), seguramente te suenen. Son quiz√°s los indices m√°s usados de diversidad (o entrop√≠a), incluso hasta una medida obligatoria en estudios de impacto ambiental de algunos pa√≠ses. A pesar de ser tan famosos y tan ampliamente usados estos indices tienen ciertos problemas (para los ec√≥logos) al momento de medir la diversidad.\n\nLas unidades de medida, ¬øen qu√© unidades se presentan los indices? Cuando Shannon es igual a 1.3, es 1.3 diversidades? especies?. Pues resulta que los indices de entrop√≠a est√°n dados en bits o nats (seg√∫n el algoritmo (Cultid-Medina and Escobar 2019))\nEl otro problema es el comportamiento de los √≠ndices de entrop√≠a no es conveniente para una medida de diversidad. Resulta que no responden proporcionalmente al aumento en la diversidad de una comunidad. Es decir: que una comunidad doblemente diversa, no tendr√° el doble del valor del √≠ndice de Shannon o Simpson. Este punto es complejo porque invalida las comparaciones de comunidades por medio de √©stos indices (Roswell, Dushoff, and Winfree 2021).\n\n\n\n\nTomado de Roswell 2021\n\n\n√âstas caracter√≠sticas fueron identificadas por MACARTHUR (1965) quien sugiri√≥ el exponencial de los √≠ndices como una medida del n√∫mero efectivo de especies. Sugerencia que hist√≥ricamente hemos olvidado y que fue se√±alado posteriormente por Jost (2006b) , quien propuso como tal el c√°lculo de la diversidad por medio del n√∫mero efectivo de especies seg√∫n la serie de Hill. Para detalles de las formulas y conceptos de la serie de Hill rem√≠tanse a la biograf√≠a citada.\n\nPerfiles de diversidad y la cobertura de la muestra\nComo ya lo vimos, la riqueza de especies es sensible a la abundancia e incluso el esfuerzo de muestreo. Pues tenemos la misma dificultad con los indices de diversidad. ¬øDe qu√© forma podemos comparar la diversidad de dos comunidades con diferente proporci√≥n de individuos muestreados? Para ello necesitamos del concepto de cobertura de la muestra (Sample coverage en ingl√©s). La cobertura de la muestra nos da una medida de la proporci√≥n de abundancia de individuos que est√° representada en nuestro muestreo. As√≠, somos capaces de igualar el esfuerzo de muestreo lo valida las estimaciones y comparaciones con sentido ecol√≥gico (Cultid-Medina and Escobar 2019).\nPara ver un ejemplo (mal ejemplo) de como usar la cobertura de la muestra vamos a usar el paquete iNEXT (Hsieh, Ma, and Chao 2022) desarrollado por Anne Chao. Para tener una comunidad con la que pueda comparar voy a generar una que sea simplemente una ‚Äúsub-comunidad‚Äù de la que tenemos.\nVamos a calcular tres perfiles de diversidad siguiendo la notaci√≥n de Jost (2006a)\n\\[\n^qD =(\\sum_{i=1}^S p_i^q)^{1/(1-q)}\n\\]\nDonde \\(p_i\\) es la abundancia proporcional de la i-√©sima especie, \\(S\\) el n√∫mero de especies y \\(q\\) el orden de diversidad (Cultid-Medina and Escobar 2019).\n\nq0= da peso a las especies raras o simplemente es la riqueza\nq1= es el inverso de Shannon y corresponde a las especies igualmente abundantes. Es decir no hay mayor peso por raras o dominantes\nq2= Equivale al inverso de Simpson y corresponde al n√∫mero efectivo de especies m√°s abundantes. Es decir que, pondera m√°s por especies dominantes\n\n\n# Valores aleatorios del uno a 31 para luego quitarlos de la base de datos\nnumbers <- sample(1:31, 16, replace= FALSE)\n\ncommunity2 <- ac_data %>% \n  slice(numbers) %>% \n  t() %>% # Transponer los datos\n  as.data.frame() %>% # De nuevo a data.frame\n  rowSums() %>% #Sumar las abundancias\n  as.data.frame() %>% # De nuevo a data frame\n  rename(abun= \".\") %>% # Nombre de la columna\n  arrange(desc(abun)) %>% # ordenar los valores\n  as.matrix() # Requiere formato de matriz\n\n# Ahora jutamos en un mismo dataframe\ninext_DF <- data.frame(Spader_df, community2) %>% \n  rename(real= abun,\n         mitad= abun.1)\n\n# Ahora corremos la funci√≥n de iNEXT\ninext_ob <- iNEXT(inext_DF,\n                  q= c(0,1,2), # perfiles de diversidad\n                  datatype = \"abundance\",\n                  size = NULL, # Esfuerzo o unidades de estimaci√≥n\n                  endpoint = 1846,# espefificar el size final\n                  knots = 100, #saltos donde estimar√° diversidad\n                  se=TRUE, # Error estandar del boot\n                  conf = 0.95, # Intervalos de confianza a\n                  nboot = 50) # n√∫mero de remuestreos.\n\nTenemos un objeto lista con distinta informaci√≥n:\n\nLa primera data base contiene informaci√≥n general con el n√∫mero de individuos (n), las especies observadas (S.obs), la cobertura de la muestra (SC) y las frecuencias de especies (f1-f10). Nota en caso de usar datos de incidencia, este objeto tendr√° la frecuencia de incidencia (Q1-Q10).\n\n\nknitr::kable(inext_ob$DataInfo)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAssemblage\nn\nS.obs\nSC\nf1\nf2\nf3\nf4\nf5\nf6\nf7\nf8\nf9\nf10\n\n\n\n\nreal\n1846\n14\n0.9989\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nmitad\n1002\n12\n1.0000\n0\n0\n0\n0\n1\n1\n0\n1\n0\n0\n\n\n\n\n\n\nEl segundo objeto tiene dos data bases: Uno basado en los individuos y otro en la cobertura de la muestra. El primero contiene el nombre de los ensamblajes, el corte donde se estima la diversidad con m n√∫mero de individuos (m; el n√∫mero de ms depende de los knots), m√©todo de rarefacci√≥n (inferior al observado), observado, extrapolaci√≥n (mayor al observado): el perfil de diversidad 0,1,2 (order.q); el valor estimado de diversidad (qD); los intervalos de confianza de la estimaci√≥n de diversidad (qD.LCL, qD.UCL ); la cobertura de la muestra estimada y sus intervalos de confianza (SC, SC.LCL, SC.UCL).\n\n\nknitr::kable(head(inext_ob$iNextEst$size_based), digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAssemblage\nm\nMethod\nOrder.q\nqD\nqD.LCL\nqD.UCL\nSC\nSC.LCL\nSC.UCL\n\n\n\n\nreal\n1\nRarefaction\n0\n1.00\n1.00\n1.00\n0.20\n0.20\n0.21\n\n\nreal\n19\nRarefaction\n0\n6.17\n5.97\n6.38\n0.89\n0.88\n0.89\n\n\nreal\n38\nRarefaction\n0\n7.83\n7.53\n8.12\n0.93\n0.93\n0.94\n\n\nreal\n56\nRarefaction\n0\n8.80\n8.44\n9.16\n0.96\n0.95\n0.96\n\n\nreal\n75\nRarefaction\n0\n9.51\n9.11\n9.91\n0.97\n0.97\n0.97\n\n\nreal\n94\nRarefaction\n0\n10.04\n9.61\n10.47\n0.98\n0.97\n0.98\n\n\n\n\n\nLa segunda base es muy similar pero es usada para graficar la curva de cobertura de la muestra\n\nknitr::kable(head(inext_ob$iNextEst$coverage_based), digits = 2)\n\n\n\n\nAssemblage\nSC\nm\nMethod\nOrder.q\nqD\nqD.LCL\nqD.UCL\n\n\n\n\nreal\n0.20\n1\nRarefaction\n0\n1.00\n0.99\n1.01\n\n\nreal\n0.89\n19\nRarefaction\n0\n6.17\n5.79\n6.56\n\n\nreal\n0.93\n38\nRarefaction\n0\n7.83\n7.34\n8.31\n\n\nreal\n0.96\n56\nRarefaction\n0\n8.80\n8.28\n9.32\n\n\nreal\n0.97\n75\nRarefaction\n0\n9.51\n8.98\n10.05\n\n\nreal\n0.98\n94\nRarefaction\n0\n10.04\n9.50\n10.58\n\n\n\n\n\n\nEl √∫ltimo objeto muestra la diversidad observada y estimada mediante estimadores asint√≥ticos. Recordemos que q=0 es la riqueza, q=1 es Inverso de Shanon y q=2 el inverso de Simpson (Chao et al. 2014).\n\nknitr::kable(inext_ob$AsyEst, digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\nAssemblage\nDiversity\nObserved\nEstimator\ns.e.\nLCL\nUCL\n\n\n\n\nmitad\nSpecies richness\n12.00\n12.00\n0.11\n12.00\n12.22\n\n\nmitad\nShannon diversity\n5.98\n6.01\n0.17\n5.68\n6.34\n\n\nmitad\nSimpson diversity\n4.67\n4.69\n0.12\n4.44\n4.93\n\n\nreal\nSpecies richness\n14.00\n15.00\n0.29\n14.42\n15.57\n\n\nreal\nShannon diversity\n6.30\n6.33\n0.15\n6.04\n6.62\n\n\nreal\nSimpson diversity\n4.91\n4.92\n0.11\n4.70\n5.15\n\n\n\n\n\n\niNext tiene funciones para graficar los perfiles muy poderosas y que usan ggplot como base. Esto √∫ltimo permite usar funciones de ggplot para modificar las im√°genes.\nEl gr√°fico de tipo 1 corresponde a la curva basada en individuos. Muy similar a lo que ya vimos con la curva de rarefacci√≥n basada en individuos. Como ven, la linea punteada corresponde a los valores extrapolados de la comunidad que inventamos. A pesar que parece una gr√°fica sencilla, tiene mucho por decir: Por ejemplo, la m√°gnitud en que difiere cada uno de los indices nos habla de la equitatividad de la comunidad. As√≠, un q0 muy cercano a q1 nos habla de una comunidad poco equitativa.\n\nggiNEXT(inext_ob, # objeto iNEXT\n        type = 1, # tipo de gr√°fica\n        se= T, # incluir intervalos\n        facet.var = \"Assemblage\", # Cuadros por comunidad\n        color.var = \"None\", # definir color\n        grey = FALSE)+ # En grises\n  theme_bw() # Tema de ggplot\n\n\n\n\nDependiendo de lo que nos interese mostrar podemos variar la especificaci√≥n de la curva. Por ejemplo, queremos comparar los perfiles de diversidad de las dos comunidades\n\nggiNEXT(inext_ob, # objeto iNEXT\n        type = 1, # tipo de gr√°fica\n        se= T, # incluir intervalos\n        facet.var = \"Order.q\", # Cuadros por perfil\n        color.var = \"Assemblage\", # definir color\n        grey = FALSE)+ # En grises\n  theme_bw() # Tema de ggplot\n\n\n\n\nPodemos observar el comportamiento de cobertura de la muestra con el gr√°fico tipo dos. Este punto es importante, porque la comparaci√≥n de las comunidades solo tiene sentido cuando ambas tienen una cobertura de la muestra equivalente. En este caso ambas comunidades tienen coberturas muy similares por lo que se valida su comparaci√≥n. En caso de tener una comunidad con menor cobertura es necesario extrapolar o interpolar con base en la cobertura. Un protocolo detallado para la comparaci√≥n v√°lida puede encontrarse en Cultid-Medina and Escobar (2019).\n\nggiNEXT(inext_ob, \n        type=2, \n        facet.var=\"None\", \n        color.var=\"Assemblage\")\n\n\n\n\n\nggiNEXT(inext_ob, \n        type=3, \n        facet.var=\"Assemblage\")\n\n\n\n\n\nggiNEXT(inext_ob, \n        type=3, \n        facet.var=\"Order.q\", \n        color.var=\"Assemblage\")\n\n\n\n\n\n\nModelando la variaci√≥n de la diversidad\nEn ocasiones nos interesa m√°s conocer que factores influyen sobre la diversidad. En este caso lo que importa la variaci√≥n observada en cada unidad de muestreo. En nuestro caso, la unidad de muestreo son las c√°maras trampa.\nEn este caso vamos a usar el paquete HillR (Li 2018), la cual tiene funciones mucho m√°s sencillas para estimar los perfiles de diversidad. Tambi√©n cabe resaltar que tiene muchas otras funciones para calcular diversidad funcional y filogen√©tica, pero en este caso solo nos interesa la diversidad taxon√≥mica.\nPara usar la funci√≥n de hill_taxa requerimos la base de datos donde las filas son los sitios y las columnas las especies. Afortunadamente, ya tenemos una base as√≠ guardada en el objeto ac_data\n\n# C√°lculo de cada perfil de diversidad\nq0 <- hill_taxa(ac_data,q= 0)\nq1 <- hill_taxa(ac_data, q=1)\nq2 <- hill_taxa(ac_data, q=2)\n\n# Unimos todo en una sola data.frame\ndiv <- data.frame(q0=q0, q1=q1, q2=q2)\n\nknitr::kable(head(div), digits = 2)\n\n\n\n\n\nq0\nq1\nq2\n\n\n\n\nCBG01\n1\n1.00\n1.00\n\n\nCBG02\n2\n1.57\n1.38\n\n\nCBG03\n2\n1.89\n1.80\n\n\nCBG04\n5\n1.52\n1.20\n\n\nCBG05\n3\n2.36\n2.05\n\n\nCBG06\n9\n3.53\n2.73\n\n\n\n\n\nAhora cargamos unas covariables y las unimos a nuestra base para modelar\n\nscale_this <- function(x){result <- as.vector(scale(x))}\n\ncovs <- read_delim(\"Data/selectedcov_nostd190821.csv\", \n    delim = \";\") %>% \n mutate_if(is.numeric, scale_this) \n\nRows: 31 Columns: 12\n-- Column specification --------------------------------------------------------\nDelimiter: \";\"\nchr (3): Station, Cam, Habitat\ndbl (9): utm_y, utm_x, Vertcover_50, Dcrops, MSAVI, Slope, Cluster, Effort, ...\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndiv_covs <- cbind(div, covs)\n\nknitr::kable(head(div_covs), digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nq0\nq1\nq2\nStation\nutm_y\nutm_x\nVertcover_50\nCam\nDcrops\nMSAVI\nSlope\nCluster\nEffort\nDpop_G\nHabitat\n\n\n\n\nCBG01\n1\n1.00\n1.00\nCBG01\n-0.32\n1.86\n-0.52\nMoultrieA30\n0.34\n0.97\n0.08\n-0.84\n0.32\n-1.01\nScrub\n\n\nCBG02\n2\n1.57\n1.38\nCBG02\n0.18\n1.54\n0.62\nMoultrie\n1.24\n-0.59\n-1.08\n-0.84\n-1.40\n-0.83\nScrub\n\n\nCBG03\n2\n1.89\n1.80\nCBG03\n0.94\n1.35\n-0.98\nMoultrieA30\n2.11\n-0.31\n-1.13\n-0.84\n0.50\n-0.60\nScrub\n\n\nCBG04\n5\n1.52\n1.20\nCBG04\n1.49\n1.16\n-0.98\nPrimos\n0.10\n0.12\n2.55\n-0.84\n-0.61\n-0.62\nColumnar\n\n\nCBG05\n3\n2.36\n2.05\nCBG05\n1.83\n0.77\n-1.21\nMoultrieA30\n0.91\n0.47\n0.32\n-0.84\n0.50\n-0.45\nScrub\n\n\nCBG06\n9\n3.53\n2.73\nCBG06\n-0.61\n1.45\n0.62\nPrimos\n1.75\n0.77\n-1.13\n-0.84\n0.50\n-0.24\nScrub\n\n\n\n\n\nVamos a realizar una selecci√≥n de modelos de manera r√°pida usando la funci√≥n dredge del paquete MuMIn (Barton 2020).\nPrimero para q0\n\nglobal_q0 <- glm(q0~ Dcrops+ MSAVI+ Slope+ Dpop_G+ Habitat,\n                 family = \"poisson\",\n                 data = div_covs,\n                 na.action = \"na.fail\") \n\nAIC_q0 <- dredge(global_q0,\n                 m.lim = c(NA, 1),\n                 rank = \"AIC\")\n\nFixed term is \"(Intercept)\"\n\nknitr::kable(AIC_q0, digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n(Intercept)\nDcrops\nDpop_G\nHabitat\nMSAVI\nSlope\ndf\nlogLik\nAIC\ndelta\nweight\n\n\n\n\n2\n1.80\n-0.12\nNA\nNA\nNA\nNA\n2\n-71.47\n146.93\n0.00\n0.29190233\n\n\n1\n1.80\nNA\nNA\nNA\nNA\nNA\n1\n-72.73\n147.45\n0.52\n0.22506372\n\n\n5\n1.92\nNA\nNA\n+\nNA\nNA\n2\n-71.94\n147.88\n0.95\n0.18153140\n\n\n3\n1.80\nNA\n0.07\nNA\nNA\nNA\n2\n-72.30\n148.61\n1.67\n0.12642361\n\n\n17\n1.80\nNA\nNA\nNA\nNA\n0.03\n2\n-72.62\n149.25\n2.31\n0.09179617\n\n\n9\n1.80\nNA\nNA\nNA\n-0.01\nNA\n2\n-72.72\n149.44\n2.51\n0.08328277\n\n\n\n\n\nEl AIC nos muestra que el mejor modelo es aquel donde la distancia a cultivos es la variable que mejor explica la riqueza de especies, con un coeficiente negativo. Es decir que a mayor distancia a cultivos, menor cantidad de especies. Es importante darse cuenta que seg√∫n los valores del AIC el modelo sin ninguna covariable es igualmente plausible. Esto nos empieza a dar se√±ales de que posiblemente las covariables no sea muy importantes para explicar la riqueza de especies.\n\nq0_pred <- ggeffect(get.models(AIC_q0, \n                               subset = 1)[[1]],\n                    terms = \"Dcrops\")\nplot(q0_pred, add.data = TRUE)\n\n\n\n\n\ntestDispersion(get.models(AIC_q0, \n                               subset = 1)[[1]],\n                alternative = \"greater\") # para sobredispersi√≥n\n\n\n\n\n\n    DHARMa nonparametric dispersion test via sd of residuals fitted vs.\n    simulated\n\ndata:  simulationOutput\ndispersion = 0.98029, p-value = 0.484\nalternative hypothesis: greater\n\n\nParece un buen modelo, pero como recordaran me invent√© las covariables as√≠ que es una coincidencia o un ejemplo de porque hay que tener cuidado incluso con las pruebas de bondad de ajuste.\nAhora para q1\n\nglobal_q1 <- lm(q1~ Dcrops+ MSAVI+ Slope+ Dpop_G+ Habitat,\n                 data = div_covs,\n                 na.action = \"na.fail\") \n\nAIC_q1 <- dredge(global_q1,\n                 m.lim = c(NA, 1),\n                 rank = \"AIC\")\n\nFixed term is \"(Intercept)\"\n\nknitr::kable(AIC_q0, digits = 1)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n(Intercept)\nDcrops\nDpop_G\nHabitat\nMSAVI\nSlope\ndf\nlogLik\nAIC\ndelta\nweight\n\n\n\n\n2\n1.8\n-0.1\nNA\nNA\nNA\nNA\n2\n-71.5\n146.9\n0.0\n0.29190233\n\n\n1\n1.8\nNA\nNA\nNA\nNA\nNA\n1\n-72.7\n147.5\n0.5\n0.22506372\n\n\n5\n1.9\nNA\nNA\n+\nNA\nNA\n2\n-71.9\n147.9\n0.9\n0.18153140\n\n\n3\n1.8\nNA\n0.1\nNA\nNA\nNA\n2\n-72.3\n148.6\n1.7\n0.12642361\n\n\n17\n1.8\nNA\nNA\nNA\nNA\n0\n2\n-72.6\n149.2\n2.3\n0.09179617\n\n\n9\n1.8\nNA\nNA\nNA\n0\nNA\n2\n-72.7\n149.4\n2.5\n0.08328277\n\n\n\n\n\nEn este caso el modelo sin covariables es el mejor\n\ncheck_model(get.models(AIC_q1, \n                               subset = 1)[[1]],\n            check = c(\"qq\", \"normality\"))\n\n\n\n\nParece ser un buen modelo.\nYa tienen las habilidades necesarias para intentar modelar q2"
  }
]